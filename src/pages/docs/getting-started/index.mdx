import { Head } from "kiru/router"
import { ExternalLink } from "$/components/atoms/ExternalLink"
import { CalloutBlock } from "$/components/atoms/CalloutBlock"
import { DocsSection } from "$/components/DocsSection"
import { packageManager } from "./packageManagerStore"
import { PackageManagerSelector } from "./PackageManagerSelector"
import { CopyInnerText } from "$/components/CopyInnerText"
import BunCliBash from "./bash.cli.bun.md"
import NpmCliBash from "./bash.cli.npm.md"
import PnpmCliBash from "./bash.cli.pnpm.md"
import YarnCliBash from "./bash.cli.yarn.md"
import BunInstallBash from "./bash.manual.bun.md"
import NpmInstallBash from "./bash.manual.npm.md"
import PnpmInstallBash from "./bash.manual.pnpm.md"
import YarnInstallBash from "./bash.manual.yarn.md"
import MountCode from "./mountCode.md"
import MountCodeTS from "./mountCode.ts.md"
import { siteCodeLang } from "$/state/siteCodeLang"
import { DISCORD_LINK } from "$/constants"
import { match } from "lit-match"

<Head.Content>
  <title>Kiru - Getting Started</title>
  <meta name="keywords" content="getting started, installation, setup, npm, pnpm, yarn, bun, vite, Kiru" />
  <meta name="description" content="Get started with Kiru by installing it in a new project or adding it to an existing project. Learn how to set up Kiru with your preferred package manager." />
</Head.Content>

# Getting started

<DocsSection id="start-a-new-project" title="Start a new project">
  <div>
    <div className="not-prose">
      <PackageManagerSelector />
      <CopyInnerText>
        {match(packageManager.value)
          .with("Bun", () => <BunCliBash />)
          .with("NPM", () => <NpmCliBash />)
          .with("Yarn", () => <YarnCliBash />)
          .with("PNPM", () => <PnpmCliBash />)
          .exhaustive()}
      </CopyInnerText>
    </div>
  </div>
</DocsSection>

<DocsSection id="add-to-an-existing-project" title="Add to an existing project">
  <CalloutBlock fontSize="normal">
    <span>The following example demonstrates adding Kiru to a <ExternalLink href="https://vitejs.dev/">Vite</ExternalLink> project.</span>
  </CalloutBlock>

  Add Kiru and the Kiru Vite plugin (for HMR and Devtools):

  <div className="not-prose">
    <PackageManagerSelector />
    <CopyInnerText>
      {match(packageManager.value)
        .with("Bun", () => <BunInstallBash />)
        .with("NPM", () => <NpmInstallBash />)
        .with("Yarn", () => <YarnInstallBash />)
        .with("PNPM", () => <PnpmInstallBash />)
        .exhaustive()}
    </CopyInnerText>
  </div>

  Update your vite.config.ts (or add it in the top level of your project) and add the HMR plugin:

  <CopyInnerText>
    ```ts
    import { defineConfig } from "vite"
    import kiru from "vite-plugin-kiru"

    export default defineConfig({
      plugins: [kiru()],
    })
    ```
  </CopyInnerText>

  <span>Add the "jsx" entry in your tsconfig.json:</span>

  ```json
  {
    "compilerOptions": {
      ...
      "jsx": "preserve",
      ...
    }
  }
  ```

  <span>Create a simple app:</span>

  <CopyInnerText>
    ```jsx
    export function App() {
      return <h1>Hello world!</h1>
    }
    ```
  </CopyInnerText>

  <span>Mount your app to the DOM:</span>
  
  <div className="not-prose">
    <CopyInnerText>
      {siteCodeLang.value === "js" ? <MountCode /> : <MountCodeTS />}
    </CopyInnerText>
  </div>

</DocsSection>

<DocsSection id="getting-help" title="Getting help">
  Reach out to us or get involved on <ExternalLink href={DISCORD_LINK}>Discord</ExternalLink>
</DocsSection>